<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ƒê·∫øm ng∆∞·ª£c ng√†y gi·ªó</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      color: #333;
      text-align: center;
      padding: 50px;
    }
    h1 {
      color: #b30000;
    }
    #countdown {
      font-size: 2rem;
      margin: 20px 0;
    }
    #eventName {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #004080;
    }
    #eventDates {
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <h1>‚è≥ ƒê·∫øm ng∆∞·ª£c ƒë·∫øn ng√†y gi·ªó g·∫ßn nh·∫•t</h1>
  <div id="eventName">ƒêang t·∫£i...</div>
  <div id="eventDates"></div>
  <div id="countdown"></div>

  <script>
    const gioList = [
      { name: "Ph·∫°m VƒÉn Nhu", date: "08/04" },
      { name: "L√™ Th·ªã Nguy·ªát", date: "13/04" },
      { name: "Nguy·ªÖn H·ªØu Ng√¢n", date: "14/05" },
      { name: "Ph·∫°m VƒÉn Ti√™m", date: "01/08" },
      { name: "L√™ Th·ªã S·ª≠u", date: "23/09" },
      { name: "L√™ Th·ªã Vi·ªÖn", date: "01/10" },
      { name: "Ph·∫°m VƒÉn H·ª£i", date: "27/10" },
      { name: "V≈© Th·ªã L∆°", date: "15/12" },
    ];

    async function convertLunarToSolarViaAPI(lunarDay, lunarMonth, year) {
      try {
        const url = `https://api.vietconvert.com/am-duong?ngay=${lunarDay}&thang=${lunarMonth}&nam=${year}`;
        const res = await fetch(url);
        const data = await res.json();
        if (data && data.success) {
          const { ngay, thang, nam } = data.data;
          return new Date(`${nam}-${thang}-${ngay}`);
        } else {
          console.error("L·ªói l·∫•y ng√†y d∆∞∆°ng t·ª´ API");
          return null;
        }
      } catch (e) {
        console.error("L·ªói g·ªçi API:", e);
        return null;
      }
    }

    async function getNextGio() {
      const today = new Date();
      const currentYear = today.getFullYear();
      const events = [];

      for (const entry of gioList) {
        const [dd, mm] = entry.date.split("/").map(Number);
        let solarDate = await convertLunarToSolarViaAPI(dd, mm, currentYear);
        if (!solarDate) continue;
        if (solarDate < today) {
          solarDate = await convertLunarToSolarViaAPI(dd, mm, currentYear + 1);
        }
        events.push({ ...entry, dDate: solarDate });
      }

      events.sort((a, b) => a.dDate - b.dDate);
      return events[0];
    }

    async function updateCountdown() {
      const next = await getNextGio();
      const now = new Date();
      const diff = Math.floor((next.dDate - now) / 1000);
      const days = Math.floor(diff / 86400);
      const hours = Math.floor((diff % 86400) / 3600);
      const minutes = Math.floor((diff % 3600) / 60);
      const seconds = diff % 60;

      document.getElementById("countdown").textContent =
        `${days} ng√†y ${hours} gi·ªù ${minutes} ph√∫t ${seconds} gi√¢y`;

      document.getElementById("eventName").textContent = `üë§ T√™n: ${next.name}`;
      document.getElementById("eventDates").innerHTML =
        `üìÖ Ng√†y d∆∞∆°ng: ${next.dDate.getDate().toString().padStart(2, '0')}/${(next.dDate.getMonth()+1).toString().padStart(2, '0')}/${next.dDate.getFullYear()}<br>` +
        `üåô Ng√†y √¢m: ${next.date}`;
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
  </script>
</body>
</html>
